import{a as c,b as d}from"./chunk-HWYJJFZ5.js";import{h as s,i as m}from"./chunk-XDCWJPAS.js";import{M as g,Q as u,R as v,k as h,l as p,o as i,x as l}from"./chunk-C264W5OG.js";var f=class o{constructor(t){this.http=t}apiUrl=c.apiUrl;useStaticData=c.useStaticData;authService=v(d);cachedEvents=null;uploadEventsExcel(t){let e=new FormData;e.append("file",t);let r=this.authService.getToken(),n=new s({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/events/upload`,e,{headers:n}).pipe(i(a=>a.data))}getAllEvents(){return this.useStaticData?this.cachedEvents?h(this.cachedEvents):this.http.get("data/events.json").pipe(i(t=>(this.cachedEvents=t,t))):this.http.get(`${this.apiUrl}/events`).pipe(i(t=>t.data))}getEventById(t){return this.useStaticData?this.getAllEvents().pipe(i(e=>{let r=e.find(n=>n.slug===t||n.id===t);if(!r)throw new Error(`Event with id/slug ${t} not found`);return r}),l(e=>(console.error("Error finding event:",e),p(()=>e)))):this.http.get(`${this.apiUrl}/events/${t}`).pipe(i(e=>e.data),l(e=>(console.error("Error loading event from API:",e),p(()=>e))))}getEventsByCategory(t){return this.useStaticData?this.getAllEvents().pipe(i(e=>e.filter(r=>r.category.toLowerCase()===t.toLowerCase()))):this.http.get(`${this.apiUrl}/events/category/${t}`).pipe(i(e=>e.data))}searchEvents(t){if(this.useStaticData){let e=t.toLowerCase();return this.getAllEvents().pipe(i(r=>r.filter(n=>n.title.toLowerCase().includes(e)||n.summary.toString().toLowerCase().includes(e)||n.context.toString().toLowerCase().includes(e))))}return this.http.get(`${this.apiUrl}/events/search`,{params:{q:t}}).pipe(i(e=>e.data))}getCategories(){return this.useStaticData?this.getAllEvents().pipe(i(t=>{let e=new Set(t.map(r=>r.category));return Array.from(e).sort()})):this.http.get(`${this.apiUrl}/events/categories`).pipe(i(t=>t.data))}uploadEventImage(t){let e=new FormData;e.append("image",t);let r=this.authService.getToken(),n=new s({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/events/upload-image`,e,{headers:n}).pipe(i(a=>a.data))}uploadEventImages(t){let e=new FormData;t.forEach(a=>{e.append("images",a)});let r=this.authService.getToken(),n=new s({Authorization:`Bearer ${r}`});return this.http.post(`${this.apiUrl}/events/upload-images`,e,{headers:n}).pipe(i(a=>a.data))}static \u0275fac=function(e){return new(e||o)(u(m))};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{f as a};
